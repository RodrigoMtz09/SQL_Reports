# 500 Most Expensive Players in Football
#### Author: Rodrigo Martinez Mina

![5801794.jpeg](attachment:5801794.jpeg)

## Introduction

Based on Encyclopedia Britannica, football is the most popular sport in the world in numbers of spectators and participants. In 2019, the total revenue generated by the global football industry was estimated to be around $28.4 billion dollars. And, accoridng to FIFA, the international governing body of football, there are currently 211 members associations representing over 300 million registered players in thousands of teams worldwide. 

In this project, we will analyze data on the 500 most expensive football players in 2021, including their current value, performance statatistics and demographic information to gain insights into the factors that drive player valuation and to identify patterns and characteristics of the most valuable players.


The final output of the project will be a comprehensive report that highlights the key findings and insights of the analysis. The report will also provide recommendations on how football clubs can use the insights gained from the analysis to make more informed decisions when it comes to player recruitment and transfer strategies.

This dataset was obtained from Kaggle.

## Data Exploration and Cleaning

First, we need to import sqlalchemy,library which provides a interface interact with SQL databases, and pandas that offers integration with SQL databases using 'read_sql' function.


```python
# Import the packages and libraries required
from sqlalchemy import create_engine
import pandas as pd
```


```python
# Regenate magic sql command
%reload_ext sql
```


```python
# To Jupyter notebook with database personal administrator 
%sql postgresql://postgres:1@localhost:5432/postgres
```

Now, we import our dataset "players" to Jupyter Notebook through pandas read_csv command


```python
# Import csv file into a pandas dataframe
df = pd.read_csv('Desktop/Data/players.csv')
```


```python
engine = create_engine("postgresql://postgres:1@localhost:5432/postgres")
df.to_sql('players', con=engine, if_exists='replace', index=False)
```




    500




```python
# Extracting the 5 first rows of our dataset
%sql SELECT * FROM players LIMIT 5;
```

     * postgresql://postgres:***@localhost:5432/postgres
    5 rows affected.





<table>
    <thead>
        <tr>
            <th>rank</th>
            <th>name</th>
            <th>position</th>
            <th>age</th>
            <th>market_value</th>
            <th>country</th>
            <th>club</th>
            <th>matches</th>
            <th>goals</th>
            <th>own_goals</th>
            <th>assists</th>
            <th>yellow_cards</th>
            <th>second_yellow_cards</th>
            <th>red_cards</th>
            <th>number_of_substitute_in</th>
            <th>number_of_substitute_out</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>0</td>
            <td>Kylian Mbappé</td>
            <td>Centre-Forward</td>
            <td>22</td>
            <td>144.0</td>
            <td>France</td>
            <td>Paris Saint-Germain</td>
            <td>16</td>
            <td>7</td>
            <td>0</td>
            <td>11</td>
            <td>3</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>8</td>
        </tr>
        <tr>
            <td>1</td>
            <td>Erling Haaland</td>
            <td>Centre-Forward</td>
            <td>21</td>
            <td>135.0</td>
            <td>Norway</td>
            <td>Borussia Dortmund</td>
            <td>10</td>
            <td>13</td>
            <td>0</td>
            <td>4</td>
            <td>1</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>1</td>
        </tr>
        <tr>
            <td>2</td>
            <td>Harry Kane</td>
            <td>Centre-Forward</td>
            <td>28</td>
            <td>108.0</td>
            <td>England</td>
            <td>Tottenham Hotspur</td>
            <td>16</td>
            <td>7</td>
            <td>0</td>
            <td>2</td>
            <td>2</td>
            <td>0</td>
            <td>0</td>
            <td>2</td>
            <td>2</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Jack Grealish</td>
            <td>Left Winger</td>
            <td>26</td>
            <td>90.0</td>
            <td>England</td>
            <td>Manchester City</td>
            <td>15</td>
            <td>2</td>
            <td>0</td>
            <td>3</td>
            <td>1</td>
            <td>0</td>
            <td>0</td>
            <td>2</td>
            <td>8</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Mohamed Salah</td>
            <td>Right Winger</td>
            <td>29</td>
            <td>90.0</td>
            <td>Egypt</td>
            <td>Liverpool FC</td>
            <td>15</td>
            <td>15</td>
            <td>0</td>
            <td>6</td>
            <td>1</td>
            <td>0</td>
            <td>0</td>
            <td>0</td>
            <td>3</td>
        </tr>
    </tbody>
</table>




```python
# Counting the number of rows in our dataset
%sql SELECT COUNT(*) FROM players
```

     * postgresql://postgres:***@localhost:5432/postgres
    1 rows affected.





<table>
    <thead>
        <tr>
            <th>count</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>500</td>
        </tr>
    </tbody>
</table>



This dataset only contains the information of the 500 most expensive players in the world.


```python
# This command retrieves the columns name of our dataset and its datatype
%sql SELECT column_name, data_type 
FROM information_schema.columns 
WHERE table_name = 'players' 
ORDER BY column_name;
```

     * postgresql://postgres:***@localhost:5432/postgres
    16 rows affected.





<table>
    <thead>
        <tr>
            <th>column_name</th>
            <th>data_type</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>age</td>
            <td>bigint</td>
        </tr>
        <tr>
            <td>assists</td>
            <td>bigint</td>
        </tr>
        <tr>
            <td>club</td>
            <td>text</td>
        </tr>
        <tr>
            <td>country</td>
            <td>text</td>
        </tr>
        <tr>
            <td>goals</td>
            <td>bigint</td>
        </tr>
        <tr>
            <td>market_value</td>
            <td>double precision</td>
        </tr>
        <tr>
            <td>matches</td>
            <td>bigint</td>
        </tr>
        <tr>
            <td>name</td>
            <td>text</td>
        </tr>
        <tr>
            <td>number_of_substitute_in</td>
            <td>bigint</td>
        </tr>
        <tr>
            <td>number_of_substitute_out</td>
            <td>bigint</td>
        </tr>
        <tr>
            <td>own_goals</td>
            <td>bigint</td>
        </tr>
        <tr>
            <td>position</td>
            <td>text</td>
        </tr>
        <tr>
            <td>rank</td>
            <td>bigint</td>
        </tr>
        <tr>
            <td>red_cards</td>
            <td>bigint</td>
        </tr>
        <tr>
            <td>second_yellow_cards</td>
            <td>bigint</td>
        </tr>
        <tr>
            <td>yellow_cards</td>
            <td>bigint</td>
        </tr>
    </tbody>
</table>



This dataset is composed by 16 columns. Each column is explained briefly below:

* **Age:** Current age of the player
* **Assists:** Number of assists made by the player. 
* **Club:**	Current football club that the player is playing for
* **Country:** The country that the player is from 
* **Goals:**	Number of goals scored by the player in a given periof of time
* **Market_value:**	Estimate of the player's market value (In millions)
* **Matches:**	Number of matches the player has played 
* **Name:**	Nome of the football player
* **Number_of_substitute_in:**	Number of times the player has been substituted into a match as a replacement for another player. 
* **Number_of_substitute_out:**	Number of times the player has been substituted out of a match and replaced by another player
* **Own_goals:**	Number of own goals scored by the player in a given period of time.
* **Position:**	Position that the player typically plays in on the field
* **Rank:**	Player's ranking within the dataset
* **Red_cards:**	Number of red cards that the player has received 
* **Second_yellow_cards:**	Number of second yellow cards that the player has received
* **Yellow_cards:**	Number of yellow cards that the player has received

It's important to notice that the command mentioned above also displays the data type of each column. To improve better accuracy of our analysis, we intend to convert the numeric columns to integer, rather than using bigint or double precision.


```python
# To change the data type of numeric columns to integer
%sql ALTER TABLE players 
ALTER COLUMN age TYPE INTEGER, 
ALTER COLUMN assists TYPE INTEGER, 
ALTER COLUMN goals TYPE INTEGER, 
ALTER COLUMN market_value TYPE INTEGER, 
ALTER COLUMN matches TYPE INTEGER, 
ALTER COLUMN number_of_substitute_in TYPE INTEGER, 
ALTER COLUMN number_of_substitute_out TYPE INTEGER, 
ALTER COLUMN own_goals TYPE INTEGER, 
ALTER COLUMN rank TYPE INTEGER, 
ALTER COLUMN red_cards	 TYPE INTEGER, 
ALTER COLUMN second_yellow_cards TYPE INTEGER, 
ALTER COLUMN yellow_cards TYPE INTEGER;
```

     * postgresql://postgres:***@localhost:5432/postgres
    Done.





    []




```python
# To verify that the changes have been made correctly
%sql SELECT column_name, data_type FROM information_schema.columns WHERE table_name = 'players' ORDER BY column_name;
```

     * postgresql://postgres:***@localhost:5432/postgres
    16 rows affected.





<table>
    <thead>
        <tr>
            <th>column_name</th>
            <th>data_type</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>age</td>
            <td>integer</td>
        </tr>
        <tr>
            <td>assists</td>
            <td>integer</td>
        </tr>
        <tr>
            <td>club</td>
            <td>text</td>
        </tr>
        <tr>
            <td>country</td>
            <td>text</td>
        </tr>
        <tr>
            <td>goals</td>
            <td>integer</td>
        </tr>
        <tr>
            <td>market_value</td>
            <td>integer</td>
        </tr>
        <tr>
            <td>matches</td>
            <td>integer</td>
        </tr>
        <tr>
            <td>name</td>
            <td>text</td>
        </tr>
        <tr>
            <td>number_of_substitute_in</td>
            <td>integer</td>
        </tr>
        <tr>
            <td>number_of_substitute_out</td>
            <td>integer</td>
        </tr>
        <tr>
            <td>own_goals</td>
            <td>integer</td>
        </tr>
        <tr>
            <td>position</td>
            <td>text</td>
        </tr>
        <tr>
            <td>rank</td>
            <td>integer</td>
        </tr>
        <tr>
            <td>red_cards</td>
            <td>integer</td>
        </tr>
        <tr>
            <td>second_yellow_cards</td>
            <td>integer</td>
        </tr>
        <tr>
            <td>yellow_cards</td>
            <td>integer</td>
        </tr>
    </tbody>
</table>



As we can see, the numeric columns have been converted to the appropiate data type for more efficient analysis.


```python
# Determining the total count of rows that contain a missing value
%sql SELECT COUNT(*) 
FROM players 
WHERE market_value IS NULL OR position IS NULL
```

     * postgresql://postgres:***@localhost:5432/postgres
    1 rows affected.





<table>
    <thead>
        <tr>
            <th>count</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>0</td>
        </tr>
    </tbody>
</table>



The absence of any missing values in the dataset, as confirmed by the query results, means that we can proceed with analyzing the data without any concerns about missing data. This eliminates the need for us to perform any imputations or further data cleaning to address missing values.

## Problems to Solve

After gaining a better understanding of our dataset, our next objective is to address the following questions:

* Who are the top 10 most expensive football players, and what are their key attributes (e.g., position, age, nationality, club, etc.)?
* What is the distribution of players by position in the dataset?
* Which clubs have the most number of expensive players?
* Which player has played the highest number of matches in the dataset?
* Who is the player with the highest number of assists in your database?
* Who is the player with the highest number of yellow cards in your database?
* How many players have scored more than 20 goals in the dataset?
* Which position has the highest number of red cards in the dataset?
* Which countries produce the most expensive football players?
* How do player valuations compare across different age groups (under 21, 21-25, 26-30, etc.)?
* Which is the highest market value by position?
* Which position has the highest average market value among the top 500 players?
* Players in the top 500 with a considerable matches as a substitute (substitute_in)
* Can we identify any outliers or unusual patterns in the data, and what might explain these anomalies?

## Analyzing the data

### Who are the top 10 most expensive football players, and what are their key attributes?


```python
# Determining the total count of rows that contain a missing value
%sql SELECT name, market_value, club, position, country 
FROM players 
ORDER BY market_value DESC 
LIMIT 10;
```

     * postgresql://postgres:***@localhost:5432/postgres
    10 rows affected.





<table>
    <thead>
        <tr>
            <th>name</th>
            <th>market_value</th>
            <th>club</th>
            <th>position</th>
            <th>country</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Kylian Mbappé</td>
            <td>144</td>
            <td>Paris Saint-Germain</td>
            <td>Centre-Forward</td>
            <td>France</td>
        </tr>
        <tr>
            <td>Erling Haaland</td>
            <td>135</td>
            <td>Borussia Dortmund</td>
            <td>Centre-Forward</td>
            <td>Norway</td>
        </tr>
        <tr>
            <td>Harry Kane</td>
            <td>108</td>
            <td>Tottenham Hotspur</td>
            <td>Centre-Forward</td>
            <td>England</td>
        </tr>
        <tr>
            <td>Romelu Lukaku</td>
            <td>90</td>
            <td>Chelsea FC</td>
            <td>Centre-Forward</td>
            <td>Belgium</td>
        </tr>
        <tr>
            <td>Jack Grealish</td>
            <td>90</td>
            <td>Manchester City</td>
            <td>Left Winger</td>
            <td>England</td>
        </tr>
        <tr>
            <td>Kevin De Bruyne</td>
            <td>90</td>
            <td>Manchester City</td>
            <td>Attacking Midfield</td>
            <td>Belgium</td>
        </tr>
        <tr>
            <td>Neymar</td>
            <td>90</td>
            <td>Paris Saint-Germain</td>
            <td>Left Winger</td>
            <td>Brazil</td>
        </tr>
        <tr>
            <td>Mohamed Salah</td>
            <td>90</td>
            <td>Liverpool FC</td>
            <td>Right Winger</td>
            <td>Egypt</td>
        </tr>
        <tr>
            <td>Frenkie de Jong</td>
            <td>81</td>
            <td>FC Barcelona</td>
            <td>Central Midfield</td>
            <td>Netherlands</td>
        </tr>
        <tr>
            <td>Jadon Sancho</td>
            <td>81</td>
            <td>Manchester United</td>
            <td>Left Winger</td>
            <td>England</td>
        </tr>
    </tbody>
</table>



This table shows the current 10 most expensive football players in the market with their respective market value, football club, position played and country of origin. 

As we can notice, the French centre-forward, Kylian Mbappé, is the most expensive player in the dataset, estimated at 144 million of euros. Players such as Erling Haaland and the Harry Kane also hold high market values. 

Meanwhile, the Egyptian Mohamed Salah, Frenkie de Jong and Jadon Sancho are positioned towars the end of the list.  

### What is the distribution of players by position in the dataset?


```python
# Determining the total count of rows that contain a missing value
%sql SELECT position, COUNT(name) as number_of_players 
FROM players 
GROUP BY position 
ORDER BY number_of_players DESC; 
```

     * postgresql://postgres:***@localhost:5432/postgres
    13 rows affected.





<table>
    <thead>
        <tr>
            <th>position</th>
            <th>number_of_players</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Centre-Back</td>
            <td>87</td>
        </tr>
        <tr>
            <td>Central Midfield</td>
            <td>74</td>
        </tr>
        <tr>
            <td>Centre-Forward</td>
            <td>70</td>
        </tr>
        <tr>
            <td>Right Winger</td>
            <td>48</td>
        </tr>
        <tr>
            <td>Left Winger</td>
            <td>46</td>
        </tr>
        <tr>
            <td>Attacking Midfield</td>
            <td>41</td>
        </tr>
        <tr>
            <td>Defensive Midfield</td>
            <td>41</td>
        </tr>
        <tr>
            <td>Right-Back</td>
            <td>30</td>
        </tr>
        <tr>
            <td>Left-Back</td>
            <td>23</td>
        </tr>
        <tr>
            <td>Goalkeeper</td>
            <td>19</td>
        </tr>
        <tr>
            <td>Left Midfield</td>
            <td>8</td>
        </tr>
        <tr>
            <td>Second Striker</td>
            <td>8</td>
        </tr>
        <tr>
            <td>Right Midfield</td>
            <td>5</td>
        </tr>
    </tbody>
</table>



The above table shows the number of players in each position of the dataset. As we can see, players located in the centre of the field are the ones who tend to have a higher market value gue thir impotant responsibilities such as creating and distributing play and defending. team's goal. 

On the other hand, positions such as right midfield and second striker are the least common with only 5 and 8 players respectively. 

This information could be useful for teams and scouts looking to fill specific positions in their squad. This table provides that some positions tend to have a higher price than others. 

### Which clubs have the most number of expensive players?


```python
# Determining the total count of rows that contain a missing value
%sql SELECT club, COUNT(*) AS number_of_players 
FROM players 
GROUP BY club 
ORDER BY number_of_players DESC 
LIMIT 10;
```

     * postgresql://postgres:***@localhost:5432/postgres
    10 rows affected.





<table>
    <thead>
        <tr>
            <th>club</th>
            <th>number_of_players</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Manchester United</td>
            <td>19</td>
        </tr>
        <tr>
            <td>Manchester City</td>
            <td>18</td>
        </tr>
        <tr>
            <td>Chelsea FC</td>
            <td>16</td>
        </tr>
        <tr>
            <td>Paris Saint-Germain</td>
            <td>16</td>
        </tr>
        <tr>
            <td>Tottenham Hotspur</td>
            <td>16</td>
        </tr>
        <tr>
            <td>Real Madrid</td>
            <td>16</td>
        </tr>
        <tr>
            <td>Arsenal FC</td>
            <td>15</td>
        </tr>
        <tr>
            <td>RB Leipzig</td>
            <td>15</td>
        </tr>
        <tr>
            <td>Liverpool FC</td>
            <td>15</td>
        </tr>
        <tr>
            <td>Atlético de Madrid</td>
            <td>15</td>
        </tr>
    </tbody>
</table>



Tha table above shows the club with the most number of players in the dataset. It seems that Manchester United has highest number of expensive players with a total of 19, followed closely by Manchester City, Chelsea, PSG, Tottenham and Real Madrid. 

This indicates that these clubs have invested heavily in their squad by acquiring players with a high market value. But, this doesn't mean, neccesarily, success. There's other factor that also play a great role in achieving champioships. 

### Which player has played the highest number of matches in the dataset?


```python
# Determining the total count of rows that contain a missing value
%sql SELECT rank, name, position, club, matches 
FROM players 
ORDER BY matches DESC 
LIMIT 1;
```

     * postgresql://postgres:***@localhost:5432/postgres
    1 rows affected.





<table>
    <thead>
        <tr>
            <th>rank</th>
            <th>name</th>
            <th>position</th>
            <th>club</th>
            <th>matches</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>388</td>
            <td>Sofiane Diop</td>
            <td>Attacking Midfield</td>
            <td>AS Monaco</td>
            <td>24</td>
        </tr>
    </tbody>
</table>



Sofiane Diop is the player with the most number of matches (24 matches) played in the dataset. This could mean he's a regular player in his team (AS Monaco) which could be an indication of his skills and performance on the field. However, in terms of market value, he's positioned in the rank 388. 

This actually could be useful for recruiters, as considering potential options based on regularity and possible undervalued price. But, it's important to remember to consider other factors such as age, playing style or performance. 

### Who is the player with the highest number of assists in the database?


```python
# Player with the highest number of assists in the dataset
%sql SELECT rank, name, assists, position, club 
FROM players 
ORDER BY assists DESC 
LIMIT 1;
```

     * postgresql://postgres:***@localhost:5432/postgres
    1 rows affected.





<table>
    <thead>
        <tr>
            <th>rank</th>
            <th>name</th>
            <th>assists</th>
            <th>position</th>
            <th>club</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>238</td>
            <td>Thomas Müller</td>
            <td>12</td>
            <td>Second Striker</td>
            <td>Bayern Munich</td>
        </tr>
    </tbody>
</table>



The player with the highest number of assists (when a player sets up another player to score a goal) is Thomas Müller with a total of 12 assists. It's interesting to note that despite playing for Bayern Munich and having the most assists, he is only ranked 238th in terms of market value.

### Who is the player with the highest number of yellow cards in the database?


```python
# Player with the highest number of yellow cards 
%sql SELECT rank, name, position, club, yellow_cards 
FROM players 
ORDER BY yellow_cards DESC 
LIMIT 1;
```

     * postgresql://postgres:***@localhost:5432/postgres
    1 rows affected.





<table>
    <thead>
        <tr>
            <th>rank</th>
            <th>name</th>
            <th>position</th>
            <th>club</th>
            <th>yellow_cards</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>115</td>
            <td>Moussa Diaby</td>
            <td>Left Winger</td>
            <td>Bayer 04 Leverkusen</td>
            <td>7</td>
        </tr>
    </tbody>
</table>



The Left-Winger Moussa Diaby is, surprisingly, the player with the highest number of yellow cards in the dataset with 7, despite the common assumption that defenders receive more yellow cards. This output challenges the idea the position determins the number of yellow cards a player can receive. 

### How many players have scored more than 20 goals in the dataset?


```python
# Determining those players who have score more than 20 goals
%sql SELECT rank, name, club, goals 
FROM players WHERE goals > 20 
ORDER BY goals DESC;
```

     * postgresql://postgres:***@localhost:5432/postgres
    1 rows affected.





<table>
    <thead>
        <tr>
            <th>rank</th>
            <th>name</th>
            <th>club</th>
            <th>goals</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>63</td>
            <td>Robert Lewandowski</td>
            <td>Bayern Munich</td>
            <td>23</td>
        </tr>
    </tbody>
</table>



Out of all the players in the dataset, only Robert Lewandowski has scored more than 20 goals making him the top goal scorer with a rank of 63 based on market value. Again, other factor must be considered, but teams and recruiters should also take into account a player's scoring rate at the time of selection. 

### Which position has the highest number of red cards in the dataset?


```python
# Position with the highest number of red cards (SUM red_cards by position)
%sql SELECT position, SUM(red_cards) as total_red_cards 
FROM players 
GROUP BY position 
HAVING SUM(red_cards) > 0 
ORDER BY total_red_cards DESC;
```

     * postgresql://postgres:***@localhost:5432/postgres
    7 rows affected.





<table>
    <thead>
        <tr>
            <th>position</th>
            <th>total_red_cards</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Centre-Back</td>
            <td>8</td>
        </tr>
        <tr>
            <td>Right-Back</td>
            <td>4</td>
        </tr>
        <tr>
            <td>Centre-Forward</td>
            <td>3</td>
        </tr>
        <tr>
            <td>Central Midfield</td>
            <td>3</td>
        </tr>
        <tr>
            <td>Attacking Midfield</td>
            <td>2</td>
        </tr>
        <tr>
            <td>Second Striker</td>
            <td>2</td>
        </tr>
        <tr>
            <td>Defensive Midfield</td>
            <td>1</td>
        </tr>
    </tbody>
</table>



The table above shows that Centre-Back and Right-Back (defending positions) have the highest number of red cards in the dataset. This might not be that surprising, since these positions are responsible for defending and making tackles, which can sometimes lead to a red card. 

Other factors can influce such as individual player behavior and the specific match situation.

### Which countries produce the most number expensive football players?


```python
# Display the countries with the most number of players in the dataset (Top 15)
%sql SELECT country, COUNT(*) AS total_of_expensive_players 
FROM players 
GROUP BY country 
ORDER BY total_of_expensive_players DESC 
LIMIT 15;
```

     * postgresql://postgres:***@localhost:5432/postgres
    15 rows affected.





<table>
    <thead>
        <tr>
            <th>country</th>
            <th>total_of_expensive_players</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>England</td>
            <td>67</td>
        </tr>
        <tr>
            <td>France</td>
            <td>58</td>
        </tr>
        <tr>
            <td>Spain</td>
            <td>52</td>
        </tr>
        <tr>
            <td>Brazil</td>
            <td>41</td>
        </tr>
        <tr>
            <td>Germany</td>
            <td>29</td>
        </tr>
        <tr>
            <td>Italy</td>
            <td>26</td>
        </tr>
        <tr>
            <td>Portugal</td>
            <td>26</td>
        </tr>
        <tr>
            <td>Argentina</td>
            <td>22</td>
        </tr>
        <tr>
            <td>Netherlands</td>
            <td>17</td>
        </tr>
        <tr>
            <td>Belgium</td>
            <td>14</td>
        </tr>
        <tr>
            <td>Uruguay</td>
            <td>11</td>
        </tr>
        <tr>
            <td>Croatia</td>
            <td>8</td>
        </tr>
        <tr>
            <td>Cote d&#x27;Ivoire</td>
            <td>8</td>
        </tr>
        <tr>
            <td>Colombia</td>
            <td>7</td>
        </tr>
        <tr>
            <td>Denmark</td>
            <td>7</td>
        </tr>
    </tbody>
</table>



As we can see, England has the highest number of players within the dataset of the 500 most expensive payers in the world, with a total of 67. France, Spain, Brazil and Germany have also a considerable number of players. 

It's interesting to see that majority of the countries on this list are from Europe. 
Meanwhile, only Brazil, Argentina, Uruguay and Colombia represent South America and Cote d'Ivore as the only country representing Africa. 

This reflects the dominance of European football leagues in terms of the development of youth academies and scouting systems, as they are able to identify and develop talented players from a young age. Being a player with the background of a specific country can lead to higher demand and, consequently, a higher market value.

### Total of players on the dataset distibuted across different age groups?


```python
# Count of players by different age groups 
%sql SELECT CASE 
WHEN age < 21 THEN 'under 21' 
WHEN age BETWEEN 21 AND 25 THEN '21 - 25' 
WHEN age BETWEEN 26 AND 30 THEN '26 - 30' 
ELSE '+30' END AS age_group, 
COUNT(*) AS total_of_players 
FROM players 
GROUP BY age_group 
ORDER BY age_group DESC;
```

     * postgresql://postgres:***@localhost:5432/postgres
    4 rows affected.





<table>
    <thead>
        <tr>
            <th>age_group</th>
            <th>total_of_players</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>under 21</td>
            <td>36</td>
        </tr>
        <tr>
            <td>26 - 30</td>
            <td>194</td>
        </tr>
        <tr>
            <td>21 - 25</td>
            <td>255</td>
        </tr>
        <tr>
            <td>+30</td>
            <td>15</td>
        </tr>
    </tbody>
</table>



The table shows the number of players in each age group category in the dataset. It's remarkable to see that there's 36 players who are 20 years old or younger and who already considered to be valuable in the market. The categories '21 to 25' and '26 to 30' are the groups the highest amoun tof players, that's because they are in their physical bility and skills development. 

Finally, there are onle 36 players who are 30 years old or older. That is because their abilities and potential start to decline with age. 

### Which is the highest market value by position?


```python
# Determining the highest market value by position (From highest to lowest)
%sql SELECT position, MAX(market_value) AS max_market_value 
FROM players 
GROUP BY position 
ORDER BY max_market_value DESC;
```

     * postgresql://postgres:***@localhost:5432/postgres
    13 rows affected.





<table>
    <thead>
        <tr>
            <th>position</th>
            <th>max_market_value</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Centre-Forward</td>
            <td>144</td>
        </tr>
        <tr>
            <td>Attacking Midfield</td>
            <td>90</td>
        </tr>
        <tr>
            <td>Right Winger</td>
            <td>90</td>
        </tr>
        <tr>
            <td>Left Winger</td>
            <td>90</td>
        </tr>
        <tr>
            <td>Central Midfield</td>
            <td>81</td>
        </tr>
        <tr>
            <td>Defensive Midfield</td>
            <td>81</td>
        </tr>
        <tr>
            <td>Right-Back</td>
            <td>68</td>
        </tr>
        <tr>
            <td>Centre-Back</td>
            <td>68</td>
        </tr>
        <tr>
            <td>Goalkeeper</td>
            <td>63</td>
        </tr>
        <tr>
            <td>Second Striker</td>
            <td>63</td>
        </tr>
        <tr>
            <td>Left-Back</td>
            <td>63</td>
        </tr>
        <tr>
            <td>Left Midfield</td>
            <td>58</td>
        </tr>
        <tr>
            <td>Right Midfield</td>
            <td>27</td>
        </tr>
    </tbody>
</table>



This table displays the highets market value by position. The attacking positions (associated with goal-scoring) are the ones with highest market value. In contrast, defending position such as Right/Left Midfield or Left-Back are the positions with the lowest market value in the dataset. 

The highest market value belongs to the Centre-Forward Position with a value of 144 millions od euros. This could reflect the importance on attacking players in football and the tendency for teams to invest more in those positions. 

### Which position has the highest average market value among the top 500 players?


```python
# Determining the average market value by position (From highest to lowest)
%sql SELECT position, ROUND(AVG(market_value),2) AS avg_market_value 
FROM players 
GROUP BY position 
ORDER BY avg_market_value DESC;
```

     * postgresql://postgres:***@localhost:5432/postgres
    13 rows affected.





<table>
    <thead>
        <tr>
            <th>position</th>
            <th>avg_market_value</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Left Winger</td>
            <td>35.70</td>
        </tr>
        <tr>
            <td>Second Striker</td>
            <td>35.00</td>
        </tr>
        <tr>
            <td>Centre-Forward</td>
            <td>33.84</td>
        </tr>
        <tr>
            <td>Central Midfield</td>
            <td>32.69</td>
        </tr>
        <tr>
            <td>Attacking Midfield</td>
            <td>32.49</td>
        </tr>
        <tr>
            <td>Defensive Midfield</td>
            <td>31.12</td>
        </tr>
        <tr>
            <td>Goalkeeper</td>
            <td>30.79</td>
        </tr>
        <tr>
            <td>Left-Back</td>
            <td>30.61</td>
        </tr>
        <tr>
            <td>Right Winger</td>
            <td>30.44</td>
        </tr>
        <tr>
            <td>Centre-Back</td>
            <td>29.62</td>
        </tr>
        <tr>
            <td>Left Midfield</td>
            <td>27.00</td>
        </tr>
        <tr>
            <td>Right-Back</td>
            <td>26.10</td>
        </tr>
        <tr>
            <td>Right Midfield</td>
            <td>21.00</td>
        </tr>
    </tbody>
</table>



Although Centre-Forward is the most valuable position, Left Winger and Second Striker have a higher average market value. This also suggests that there may be ahigher demand for players in these positions, even if they are not necessarily the most expensive player overall. 

There could be different explanations or reasons about this output. One of them is that these positions may favored many teams and managers. 

### Players with their rank with a considerable matches as a substitute


```python
# Players with the most number of matches as substitutes
%sql SELECT rank, name, matches, number_of_substitute_in 
FROM players WHERE number_of_substitute_in > 0 
ORDER BY number_of_substitute_in DESC 
LIMIT 15;
```

     * postgresql://postgres:***@localhost:5432/postgres
    15 rows affected.





<table>
    <thead>
        <tr>
            <th>rank</th>
            <th>name</th>
            <th>matches</th>
            <th>number_of_substitute_in</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>158</td>
            <td>Dejan Kulusevski</td>
            <td>15</td>
            <td>13</td>
        </tr>
        <tr>
            <td>349</td>
            <td>David Neres</td>
            <td>15</td>
            <td>13</td>
        </tr>
        <tr>
            <td>76</td>
            <td>Jamal Musiala</td>
            <td>16</td>
            <td>12</td>
        </tr>
        <tr>
            <td>280</td>
            <td>Renan Lodi</td>
            <td>15</td>
            <td>12</td>
        </tr>
        <tr>
            <td>448</td>
            <td>Erik Lamela</td>
            <td>16</td>
            <td>11</td>
        </tr>
        <tr>
            <td>64</td>
            <td>Eduardo Camavinga</td>
            <td>20</td>
            <td>11</td>
        </tr>
        <tr>
            <td>406</td>
            <td>Yusuf Yazici</td>
            <td>15</td>
            <td>11</td>
        </tr>
        <tr>
            <td>203</td>
            <td>Marcel Sabitzer</td>
            <td>13</td>
            <td>11</td>
        </tr>
        <tr>
            <td>484</td>
            <td>Éverton</td>
            <td>20</td>
            <td>10</td>
        </tr>
        <tr>
            <td>12</td>
            <td>Raheem Sterling</td>
            <td>15</td>
            <td>9</td>
        </tr>
        <tr>
            <td>207</td>
            <td>Matheus Cunha</td>
            <td>11</td>
            <td>9</td>
        </tr>
        <tr>
            <td>341</td>
            <td>Rayan Cherki</td>
            <td>17</td>
            <td>9</td>
        </tr>
        <tr>
            <td>161</td>
            <td>Rodrygo</td>
            <td>14</td>
            <td>9</td>
        </tr>
        <tr>
            <td>388</td>
            <td>Sofiane Diop</td>
            <td>24</td>
            <td>9</td>
        </tr>
        <tr>
            <td>103</td>
            <td>Hirving Lozano</td>
            <td>17</td>
            <td>8</td>
        </tr>
    </tbody>
</table>



This table shows different players who are considered as one of 500 players most expensive in the world but they have a considerable amount of matches as substitutes. Dejan Kulusevski top the list with 13 matches out of 15 as substitute. 

Interestingly, there are some players such as Raheem Sterling who is ranked in the top 15 most expensive players in the world but he has played 9 games out of 15 as substitute. 

This table actually highlights differents ideas. Coaches sometimes make strategic substitutions to bring fresh legs onto the field and change the dynamics of the game. Or even, that some players are better suited to coming off the bench as substitutes rather than full matches. 

### Can we identify any outliers or unusual patterns in the data, and what might explain these anomalies?

Given the size of the dataset, it's difficult to draw any broader conclusions about the soccer market as a whole. Additionally, the absence of outliers or anomalies may suggest that the market for soccer players is relatively stable and predictable, at least at the highest levels.

## Conclusions

Based on the data provided, we can conclude that attacking players such as Centre-Forward, Attacking Midfielders and Wingers tend to have a higher market value that defernders and midfielders. 

We can also see that Europe is the continent with the greatest amount of players among the top 500 most expensive players in the world. Which England has the highest number of players with 67, followed by France, Spain, Brazil, and Germany. This may reflect the overall dominance of European soccer leagues in the global market, as well as the concentration of wealth and resources in these countries that enable them to develop and recruit top-level talent.

Furthermore, we can see that the dataset includes a range of players of different ages, with the majority falling within the 21-30 age range. This may reflect the prime age for a football player, where they have developed their skills but are still physically capable of performing at a high level.

Finally, the analysis showed that regularity, number of goals or assists did not always have a direct correlation with the market value of a player. For instance, some players who were substitutes or had a high number of goals and assists still didn't have a higher market value. Other factors also come into play, such as their age, nationality, potential, reputation, performance in previous seasons, and even their media presence. Therefore, a player's market value is influenced by a combination of factors that go beyond their on-field performance alone.

Overall, these findings provide valuable insights into the world of soccer and the factors that contribute to player value and success on the field.


## Next Steps

Based on the limits of this analysis, here are somo potential next steps: 

* **Expand the dataset:** The current dataset only includes the 500 most expensive players in the world. In order to get a more comprehensive understanding of the factors that influence player market value. 
* **Include additional variables:** It would be really interesting to add other variables in order to have a more detailed understanding of the player market value. Some examples of variables that should be included are: number of champioships, national team player, injury history, etc. 
* **Analyze market trends over time:** Another analysis that should be perform is to analyze how market trends have changed over time, one interesting case us the impact of the COVID-19 pandemic on the football industry. 
